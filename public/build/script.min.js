/*! elliotjam.es 2014-04-10 */
function debounce(a,b,c){window.bouncing=window.bouncing||{},window.bouncing[a]&&(clearTimeout(window.bouncing[a]),delete window.bouncing[a]),window.bouncing[a]=setTimeout(c,b)}function toggleMenu(a){var b=document.getElementById("js-menu");b.className="show"==b.className?"":"show",a.preventDefault()}function enforceUrlFriendly(a,b,c){var d=getUrlFriendly(a.value,c);b.value!==d&&(b.value=d)}function getUrlFriendly(a,b){return a=a.toLowerCase().replace(/(')/g,"").replace(/([^a-z0-9])/g,"-").replace(/(--+)/g,"-"),("undefined"==typeof b||b)&&(a=a.replace(/^(-*)|(-*)$/g,"")),a}function setupHeader(){var a,b,c,d=$(window),e=d.width(),f=$(".js-cool-header"),g=f.find("nav"),h=!1;d.unbind("scroll"),g.css({display:"block",opacity:"1",position:"absolute"}),e>=780&&(a=f.outerHeight(),b=g.outerHeight(),c=f.find("h1").outerHeight(),g.css("position","fixed").show(),d.bind("scroll",function(){var d=window.pageYOffset,e=1-d/(a-(b+c));0>e&&!h?(g.hide(),h=!0):e>0&&h&&(g.show(),h=!1),a>d&&(e>0&&!h&&g.css("opacity",e),f.css("background-position","50% "+d/2+"px"))}).trigger("scroll"))}function setupLinks(){$("a.js-ajax-replace").on("click",function(a){var b,c=$(this),d=c.attr("href"),e=$("<div />",{"class":c.attr("class")+" loading"}).html('<img src="/img/tomato.gif" alt="Look ma, a tomato!" />Look ma, a tomato!'),f=!0;setTimeout(function(){b&&e.replaceWith(b),f=!1},1e3),c.replaceWith(e),$.ajax({type:"GET",url:d}).done(function(a){b=a,f||e.replaceWith(b)}),a.preventDefault()}),$("a.js-close").on("click",function(a){$(this).parent().remove(),a.preventDefault()})}function setupSearch(){$("input[type=search]").off("input").on("input",function(){var a=this.value;a?debounce("search",300,function(){search(a)}):(abortSearch(),search_xhr=$.ajax({url:"/blog",success:function(a){exitSearchMode(),$(".js-blog-content").replaceWith(a)}}))}),$(".js-clear-search").off("click").on("click",function(a){$(this).siblings("input[type=search]").val("").trigger("input"),a.preventDefault()})}function search(a){abortSearch(),search_xhr=$.ajax({url:"/blog/search",data:{q:a},success:function(a){enterSearchMode(),$(".js-blog-content").replaceWith(a)}})}function enterSearchMode(){$("body").addClass("searching")}function exitSearchMode(){$("body").removeClass("searching")}function abortSearch(){"undefined"!=typeof search_xhr&&search_xhr.abort&&(search_xhr.abort(),search_xhr=void 0),debounce("search",0,$.noop)}$(function(){var a;$(window).bind("resize",function(){clearTimeout(a),a=setTimeout(function(){setupHeader()},100)}).trigger("resize"),setupLinks(),setupSearch()});